<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SMILESåˆ†å­è¾“å…¥</title>
    <link rel="stylesheet" href="./css/examples.css">
    <link rel="stylesheet" href="./css/head.css">

    <script>
        // åœ¨å…¨å±€ä½œç”¨åŸŸå®šä¹‰å‡½æ•°(æœ€æ—©æ‰§è¡Œ)
        function submitSmiles() {
            console.log("submitSmiles å‡½æ•°è¢«è°ƒç”¨");
            
            // è·å–è¾“å…¥å€¼
            const smilesInput = document.getElementById('smilesInput');
            if (!smilesInput) {
                console.error("æœªæ‰¾åˆ°è¾“å…¥æ¡†å…ƒç´ ");
                return;
            }
            
            const smilesValue = smilesInput.value.trim();
            
            // éªŒè¯è¾“å…¥æ˜¯å¦ä¸ºç©º
            if (!smilesValue) {
                alert("è¯·è¾“å…¥SMILESå­—ç¬¦ä¸²");
                return;
            }
            
            // éªŒè¯SMILESæ ¼å¼
            const smilesRegex = /^[A-Za-z0-9@+\-\[\]\(\)=#$:\.\\\/]+$/;
            if (!smilesRegex.test(smilesValue)) {
                alert("SMILESæ ¼å¼ä¸æ­£ç¡®ï¼Œè¯·æ£€æŸ¥è¾“å…¥");
                return;
            }
            
            // æ˜¾ç¤ºå¤„ç†ä¸­çŠ¶æ€
            const molecularWeightElement = document.getElementById('molecularWeight');
            const logPElement = document.getElementById('logP');
            
            if (molecularWeightElement) molecularWeightElement.textContent = "å¤„ç†ä¸­...";
            if (logPElement) logPElement.textContent = "å¤„ç†ä¸­...";
            
            // å‘é€æ•°æ®åˆ°åç«¯
            fetch('http://10.254.29.16:11357/upload', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify({ smiles: smilesValue }),
            })
            .then(response => {
                console.log("æœåŠ¡å™¨å“åº”çŠ¶æ€:", response.status);
                if (!response.ok) {
                    throw new Error('æœåŠ¡å™¨å“åº”é”™è¯¯: ' + response.status);
                }
                return response.json();
            })
            .then(data => {
                console.log("æ¥æ”¶åˆ°æ•°æ®:", data);
                // æ›´æ–°ç»“æœæ˜¾ç¤º
                if (molecularWeightElement) molecularWeightElement.textContent = data.molecularWeight || '-';
                if (logPElement) logPElement.textContent = data.logP || '-';
            })
            .catch(error => {
                console.error("è¯·æ±‚å¤±è´¥:", error);
                alert("è¯·æ±‚å¤±è´¥ï¼Œè¯·æ£€æŸ¥ç½‘ç»œè¿æ¥æˆ–æœåŠ¡å™¨çŠ¶æ€");
                
                // æ¢å¤é»˜è®¤å€¼
                if (molecularWeightElement) molecularWeightElement.textContent = '-';
                if (logPElement) logPElement.textContent = '-';
            });
        }
    </script>
</head>
<body>
    <!-- é¡¶éƒ¨å¯¼èˆªæ ï¼ˆåŒ…å«å¯¼èˆªèœå•ï¼‰ -->
    <nav class="top-navbar">
        <div class="logo">RetroAux</div>
        
        <!-- æ°´å¹³å¯¼èˆªèœå• -->
        <ul class="nav-menu">
            <li><a href="index.html" class="nav-item"><i>âŒ‚</i> Home</a></li>
            <li><a href="examples.html" class="nav-item"><i>ğŸ“Š</i> Examples</a></li>
            <li><a href="methods.html" class="nav-item"><i>ğŸ“</i> Methods</a></li> 
            <li><a href="documentation.html" class="nav-item"><i>ğŸ“š</i> Documentation</a></li>
        </ul>
        
        <div class="navbar-right">
            <a href="about.html" class="about-link">About</a>
        </div>
    </nav>
    <div class="examples-layout">
        <div class="examples-container" id="content">
            <h1>å±•ç¤ºéƒ¨åˆ†</h1>
            
            <!-- è¾“å…¥å’Œè¾“å‡ºåŒºåŸŸ -->
            <div class="input-output-wrapper">
                <!-- è¾“å…¥åŒºåŸŸ -->
                <div class="input-section">
                    <form id="smilesForm" onsubmit="return false;">
                        <div class="input-group">
                            <input 
                                type="text" 
                                id="smilesInput" 
                                placeholder="è¯·è¾“å…¥SMILESå­—ç¬¦ä¸²ï¼ˆä¾‹å¦‚ï¼šCCOï¼‰"
                                autocomplete="off"
                                autocapitalize="off"
                                spellcheck="false"
                            >
                        </div>
                        <button type="button" id="submitBtn" onclick="submitSmiles();">æäº¤åˆ†æ</button>
                    </form>
                </div>

                <!-- è¾“å‡ºåŒºåŸŸ -->
                <div class="output-section" id="outputSection">
                    <h2 class="output-title">åˆ†æç»“æœ</h2>
                    <div class="result-container">
                        <div class="properties-list">
                            <div class="result-card">
                                <div class="result-property">
                                    <span class="property-name">åˆ†å­é‡</span>
                                    <span class="property-value" id="molecularWeight">-</span>
                                </div>
                                <div class="result-property">
                                    <span class="property-name">LogP</span>
                                    <span class="property-value" id="logP">-</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</body>
</html>